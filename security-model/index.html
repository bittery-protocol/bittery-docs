<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-security-model" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Security Model | Bittery Protocol</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.bittery.dev/security-model"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Security Model | Bittery Protocol"><meta data-rh="true" name="description" content="Abstract"><meta data-rh="true" property="og:description" content="Abstract"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.bittery.dev/security-model"><link data-rh="true" rel="alternate" href="https://docs.bittery.dev/security-model" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.bittery.dev/security-model" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.2fb61cec.css">
<script src="/assets/js/runtime~main.fd90db2d.js" defer="defer"></script>
<script src="/assets/js/main.e8908bf0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_xw8s" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"></a></div><div class="navbar__items navbar__items--right"><div class="toggle_MtT2 colorModeToggle_jbcz"><button class="clean-btn toggleButton_X9qf toggleButtonDisabled_zXIt" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_fLuu"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_B5MR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_ZF44"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_mSeP"><div class="docsWrapper_iwwn"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_Bvbq" type="button"></button><div class="docRoot_VmyI"><main class="docMainContainer_sfZu docMainContainerEnhanced_xrha"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_6DEU"><div class="docItemContainer_w1IO"><article><div class="tocCollapsible_ATFE theme-doc-toc-mobile tocMobile_FwkY"><button type="button" class="clean-btn tocCollapsibleButton_hvI9">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Security Model</h1></header>
<h2 class="anchor anchorWithStickyNavbar_IUu1" id="abstract">Abstract<a href="#abstract" class="hash-link" aria-label="Direct link to Abstract" title="Direct link to Abstract">​</a></h2>
<p>This document outlines the security assumptions, threat model, and mitigations employed by the Bittery Protocol. It covers the roles of Bitcoin L1, Ordinals inscriptions, off-chain indexers, the ICP final judge, and TSS-based payouts.</p>
<h2 class="anchor anchorWithStickyNavbar_IUu1" id="motivation">Motivation<a href="#motivation" class="hash-link" aria-label="Direct link to Motivation" title="Direct link to Motivation">​</a></h2>
<p>A formal security model clarifies what each component must guarantee and how the protocol maintains integrity in the presence of adversarial actors. It ensures implementers align on replay protection, reorg handling, and auditability.</p>
<h2 class="anchor anchorWithStickyNavbar_IUu1" id="specification">Specification<a href="#specification" class="hash-link" aria-label="Direct link to Specification" title="Direct link to Specification">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_IUu1" id="trust-minimization">Trust Minimization<a href="#trust-minimization" class="hash-link" aria-label="Direct link to Trust Minimization" title="Direct link to Trust Minimization">​</a></h3>
<ul>
<li><strong>Bitcoin L1</strong>: Provides immutable transaction ordering and settlement for bets and payouts.</li>
<li><strong>Ordinals</strong>: Stores BIIs immutably as inscriptions; integrity enforced via <code>metadata_hash</code>.</li>
<li><strong>Indexers</strong>: Untrusted but reproducible data sources; cross-validated via Merkle-root consensus.</li>
<li><strong>ICP Final Judge</strong>: Deterministic validator that enforces BII rules, performs VRF, and coordinates TSS payouts.</li>
<li><strong>TSS Committee</strong>: Holds distributed key shares to authorize spending without single-key custody.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_IUu1" id="threats-and-mitigations">Threats and Mitigations<a href="#threats-and-mitigations" class="hash-link" aria-label="Direct link to Threats and Mitigations" title="Direct link to Threats and Mitigations">​</a></h3>
<ul>
<li><strong>Replay of bets</strong>: Mitigated by <code>(g, r)</code> deduplication and <code>(txid, vout)</code> uniqueness checks.</li>
<li><strong>Chain reorgs</strong>: Mitigated by <code>k_confirm</code> waiting period and recomputation of eligibility and VRF inputs on reorg.</li>
<li><strong>Malformed OP_RETURN</strong>: CBOR schema validation rejects malformed payloads; size limits prevent resource exhaustion.</li>
<li><strong>Adversarial indexers</strong>: Multi-indexer Merkle-root consensus prevents a single indexer from censoring or injecting bets.</li>
<li><strong>Payout tampering</strong>: TSS signatures validated against round public key; output ordering and basis point checks ensure correct distribution.</li>
<li><strong>Rollover misuse</strong>: Rollover outputs remain under TSS control and are linked to target round IDs.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_IUu1" id="auditability">Auditability<a href="#auditability" class="hash-link" aria-label="Direct link to Auditability" title="Direct link to Auditability">​</a></h3>
<ul>
<li>Full reproduction from public data: BII content, Bitcoin transactions, and VRF proofs enable independent recomputation of winners and payouts.</li>
<li>Indexer APIs expose candidate bets with CBOR hex for inspection.</li>
<li>ICP stores VRF outputs, payout transactions, and state transitions to provide a verifiable audit trail.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_IUu1" id="data-structures">Data Structures<a href="#data-structures" class="hash-link" aria-label="Direct link to Data Structures" title="Direct link to Data Structures">​</a></h2>
<ul>
<li><code>AuditRecord</code>: <code>{round_id, bii_hash, candidate_bets_root, vrf_output, payout_txid}</code></li>
<li><code>SecurityConfig</code>: <code>{k_confirm, max_op_return_size, tss_threshold}</code></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_IUu1" id="validation">Validation<a href="#validation" class="hash-link" aria-label="Direct link to Validation" title="Direct link to Validation">​</a></h2>
<p>Security-critical validations include:</p>
<ol>
<li>Schema and hash checks on BII and BTRY payloads.</li>
<li>Confirmation depth enforcement before randomness and payout execution.</li>
<li>TSS signature verification on payouts and rollover spends.</li>
<li>Deduplication and window enforcement for bets.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_IUu1" id="rationale">Rationale<a href="#rationale" class="hash-link" aria-label="Direct link to Rationale" title="Direct link to Rationale">  ​</a></h2>
<p>Separating data publication (Bitcoin/Ordinals), observation (indexers), and execution (ICP) limits the trust placed in any single component. Deterministic rules allow any party to verify the protocol’s behavior against on-chain evidence.</p>
<h2 class="anchor anchorWithStickyNavbar_IUu1" id="security-considerations">Security Considerations<a href="#security-considerations" class="hash-link" aria-label="Direct link to Security Considerations" title="Direct link to Security Considerations">​</a></h2>
<ul>
<li><strong>Liveness vs. safety</strong>: Preference is given to safety; delayed VRF or TSS signing halts progress but prevents inconsistent state.</li>
<li><strong>Key management</strong>: TSS key shares must be generated and stored securely; compromise of threshold shares endangers funds.</li>
<li><strong>Economic attacks</strong>: Fee spikes or dust outputs could reduce payout accuracy; fee estimation and dust handling rules mitigate this.</li>
<li><strong>Data availability</strong>: If inscriptions or blocks become temporarily unavailable, cached <code>metadata_hash</code> and Merkle proofs allow reconstruction when data is restored.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/bittery-protocol/bittery-docs/edit/main/docs/security-model.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_ps3d" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_skLT"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_qDt5 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#abstract" class="table-of-contents__link toc-highlight">Abstract</a></li><li><a href="#motivation" class="table-of-contents__link toc-highlight">Motivation</a></li><li><a href="#specification" class="table-of-contents__link toc-highlight">Specification</a><ul><li><a href="#trust-minimization" class="table-of-contents__link toc-highlight">Trust Minimization</a></li><li><a href="#threats-and-mitigations" class="table-of-contents__link toc-highlight">Threats and Mitigations</a></li><li><a href="#auditability" class="table-of-contents__link toc-highlight">Auditability</a></li></ul></li><li><a href="#data-structures" class="table-of-contents__link toc-highlight">Data Structures</a></li><li><a href="#validation" class="table-of-contents__link toc-highlight">Validation</a></li><li><a href="#rationale" class="table-of-contents__link toc-highlight">Rationale</a></li><li><a href="#security-considerations" class="table-of-contents__link toc-highlight">Security Considerations</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>